<!doctype html>
<html lang="en">
		<script src="howler.js"></script>
		<script src="howler.spatial.min.js"></script>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<head>
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
       
        <meta name="msapplication-TileColor" content="#2b5797">
        <meta name="theme-color" content="#ffffff">
        
	<meta charset="UTF-8">
	<title>Blackout</title>
	<style>
	canvas {
		display: block;
		position: absolute;
		margin: auto;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
	}
	</style>
</head>
<body>
<script>

function myTimer() {
	 if(time>1){
		if(ping==0){
			pop.pos(-10+time,0,0,pop.play())
		}
		if(ping==1){
			pop.pos(10-time,0,0,pop.play())
		}
		if(ping==2){
			pop.pos(0,10-time,0,pop.play())
		}}
	time +=1;
	if (time==10){
		gameover.pos(0,0,0,gameover.play())
		clearInterval(clock);
		time=0;
			}
            $(".time").text("Time: "+time);
		}
var clock
time=0
score = 0
gameover=false
WIDTH  = 140
HEIGHT = 600
pi = Math.PI
SpaceBar=32
RightArrow = 39
DownArrow = 40
LeftArrow = 37
let ping
pop = new Howl({
	src: ['pop.mp3'],
	format: "mp3",
	})

gameover = new Howl({
	src: ['gameover.mp3']})
background = new Howl({
	src: ['background.mp3'],
	loop:true})
HurryUp = new Howl({
	src: ['HurryUp.mp3']})
	
	
	
	
	

function startgame() {
	background.pos(0,0,15,background.play())
	
	counter =0;
	
	// while (counter <=10){
	// 	window.setTimeout(loop(),1000);
	// 	alert("hi");
	// 	counter+=1;}
	window.setTimeout(loop(), 4000);
	
	
	document.addEventListener("keyup", function(evt) {
		if(evt.keyCode==RightArrow){
			//pop.pos(2,0,0,pop.play())
			if (ping==1){
				clearInterval(clock);
				loop();
			}
			else{
				clearInterval(clock);
				gameover.pos(0,0,0,gameover.play())
			}
	
		}
		if(evt.keyCode==LeftArrow){
			//pop.pos(-2,0,0,pop.play())
			if (ping==0){
				clearInterval(clock);
				loop();
			}
			else{
				clearInterval(clock);
				gameover.pos(0,0,0,gameover.play())
			}
		
		}
		if(evt.keyCode==DownArrow){
			//pop.pos(0,0,0,pop.play())
			if (ping==2){
				clearInterval(clock);
				loop();
			}
			else{
				clearInterval(clock);
				gameover.pos(0,0,0,gameover.play())
			}
		}
	});
}
 document.addEventListener("keydown", function(evt) {
		//HurryUp.play();
		//keystate[evt.keyCode] = true;
		if(evt.keyCode==SpaceBar){
			startgame();
		}
	});

function loop(){
	score+=1;
	time = 0;
	clock = setInterval(myTimer, 200-score);
	ping = Math.floor(Math.random() * 3); 
}

function gameover(){
	clearInterval(clock);
	gameover.pos(0,0,0,gameover.play());
	stop(background);

}

</script>
</body>
</html>